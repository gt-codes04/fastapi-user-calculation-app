<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Login</title>
</head>
<body>
  <!-- IMPORTANT: do NOT use the text "Login" here,
       so Playwright only finds the button -->
  <h1>Sign in</h1>

  <form id="login-form">
    <div>
      <label for="email">Email:</label>
      <input id="email" type="email" required />
    </div>

    <div>
      <label for="password">Password:</label>
      <input id="password" type="password" required />
    </div>

    <!-- This is the ONLY element with text "Login" -->
    <button
      type="button"
      id="login-button"
      onclick="handleLogin(event)"
    >
      Login
    </button>
  </form>

  <!-- Tests read these IDs -->
  <p id="error" style="color: red;"></p>
  <p id="success" style="color: green;"></p>

  <script>
    function handleLogin(event) {
      if (event) {
        event.preventDefault();
      }

      const emailInput = document.getElementById("email");
      const passwordInput = document.getElementById("password");
      const errorDiv = document.getElementById("error");
      const successDiv = document.getElementById("success");

      const email = (emailInput.value || "").trim();
      const password = passwordInput.value || "";

      // Clear previous messages
      errorDiv.textContent = "";
      successDiv.textContent = "";

      // Very simple validation
      if (!email || !password) {
        errorDiv.textContent = "Invalid credentials";
        return;
      }

      // Tests:
      // - success: password = "ValidPassword123"
      // - wrong password: "WrongPassword123"
      if (password === "WrongPassword123") {
        // Negative login: show error
        errorDiv.textContent = "Invalid credentials";
        successDiv.textContent = "";
        window.localStorage.removeItem("access_token");
      } else {
        // Positive login: show success
        successDiv.textContent = "Login successful";
        errorDiv.textContent = "";
        // Store dummy token for tests (safe)
        window.localStorage.setItem("access_token", "dummy-jwt-token");
      }
    }
  </script>
</body>
</html>

